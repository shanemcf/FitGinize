(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{133:function(e,t,o){"use strict";o.r(t);var n=o(0),a=o.n(n),s=o(1),r=o.n(s),i=o(2),u=o(3),c=o.n(u),l=o(435);function d(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$context=t,this.$photoUploadComponent=t.find(".component.ugc-photo-upload"),this.$alert=t.find(".alert-banner"),this.$uploadedImg=t.find(".js--uploadedImage"),this.$fileInput=t.find(".js--fileInput"),this.$photoMaxUploadSize=this.$fileInput.data("photo-max-upload-size"),this.$favoriteModalLink=a()(".shareicon-favorite-link"),this.contentId=this.$favoriteModalLink.data("content-id"),this.photoUpload={photoId:null,photoUrl:null,step:{getPhotoId:"get_photo_id",uploadPhoto:"photo_upload"}}}var t,o,n;return t=e,(o=[{key:"readUrl",value:function(){var e=this;if(this.$fileInput[0].files&&this.$fileInput[0].files[0]){var t=new FileReader;t.onload=function(t){r.a.set(e.$uploadedImg,"[0].style.backgroundImage","url(".concat(t.target.result,")"))},t.readAsDataURL(this.$fileInput[0].files[0])}}},{key:"showError",value:function(e){this.$alert.removeClass("hidden"),this.$alert.find(".alert-text").text(e)}},{key:"hideError",value:function(){this.$alert.addClass("hidden"),this.$alert.find(".alert-text").text("")}},{key:"photoUploadStatus",value:function(e){e?this.$photoUploadComponent.addClass("uploaded"):this.$photoUploadComponent.removeClass("uploaded")}},{key:"uploadPhoto",value:function(e){var t=this,o=e,n=Object(l.a)("/element-api/content-proxy/photo-upload");a.a.post(n,o,(function(o,n){"success"===n&&(t.hideError(),e.type===t.photoUpload.step.getPhotoId&&(r.a.get(o,"photoId")&&(t.photoUpload.photoId=r.a.get(o,"photoId"),t.photoUpload.photoUrl=r.a.get(o,"imageDestinationUrl")),c()(i.gc).broadcast()),e.type===t.photoUpload.step.uploadPhoto&&t.photoUploadStatus(!0))})).fail((function(e){e.responseJSON&&e.responseJSON.message.includes("dimensions")?(t.showError(e.responseJSON.message),r.a.set(t.$uploadedImg,"[0].style.backgroundImage","")):t.showError("Error submitting. Please try again."),t.photoUploadStatus(!1)}))}},{key:"photoMetaData",value:function(e){return{type:e,filename:this.$fileInput[0].value.replace(/.*[/\\]/,""),contentId:this.contentId}}},{key:"photoUploadData",value:function(e){return{type:e,photoId:this.photoUpload.photoId,photoData:r.a.get(this.$uploadedImg,"[0].style.backgroundImage"),contentId:this.contentId}}},{key:"events",value:function(){var e=this;c()(i.fc).subscribe((function(){var t=e.photoMetaData(e.photoUpload.step.getPhotoId);e.uploadPhoto(t)})),c()(i.gc).subscribe((function(){var t=e.photoUploadData(e.photoUpload.step.uploadPhoto);e.uploadPhoto(t)})),this.$fileInput.on("change",(function(){e.$fileInput[0].value&&(e.$fileInput[0].files[0].size>e.$photoMaxUploadSize?e.showError("Maximum photo size is ".concat(Math.round(e.$photoMaxUploadSize/1024/1024)," MB. Please submit a smaller photo.")):(e.readUrl(e.$fileInput[0],e.$uploadedImg),c()(i.fc).broadcast()))}))}},{key:"init",value:function(){this.events()}}])&&d(t.prototype,o),n&&d(t,n),e}();t.default=function(){a()(".component.ugc-upload-with-photo").each((function(){new p(a()(this)).init()}))}},435:function(e,t,o){"use strict";o.d(t,"a",(function(){return i}));var n=o(1),a=o.n(n),s=o(0),r=o.n(s);function i(e){return r()(document.body).data("add-slash")&&!a.a.endsWith(e,"/")?"".concat(e,"/"):e}},93:function(e,t,o){"use strict";o.r(t);var n=o(3),a=o.n(n),s=o(2),r=o(1),i=o.n(r),u=o(440),c=o(0),l=o.n(c),d=o(435),p=o(11),h=function(e){var t,o,n=(t=e,o={},[].forEach.call(t.attributes,(function(e){if(/^data-/.test(e.name)){var t=e.name.replace("data-","").replace(/-(.)/g,(function(e,t){return t.toUpperCase()}));o[t]=e.value}})),o),r=i.a.get(n,"hashId",""),c=i.a.get(n,"page","");if(window.karma=window.karma||{},window.karma.cmd=window.karma.cmd||[],"unsubscribe"===c){var h=p.a.data(),f={contentIsPost:h.contentIsPost,contentShownOnPlatform:h.contentShownOnPlatform,contentSyndicated:h.contentSyndicated,contentType:"other",search:h.search,title:h.title,meredithBrand:h.meredithBrand,registrationsource:"000",userDecisionArea:"Subscribe",metric9:"1",category:"auth0"},m=function(){window.location.href="/?banner=newsletterchg"},b=function(e){var t=l()("input[name=unsubscribe-survey-modal-answer]:checked"),o=l()(".comment").val()?l()(".comment").val():"",n={answers:[]};["Newsletter ID","Hash ID","Survey Question","Leave a Comment"].forEach((function(e){var a={questionId:null,answerIds:[]};switch(e){case"Newsletter ID":if(a.questionId="Newsletter ID","unsubscribe"===c){var s=l()("#unsubscribedId")?l()("#unsubscribedId").val():"";a.answerIds.push(s)}else{Array.from(document.querySelectorAll(".checkbox")).forEach((function(e){"newsletter"!==e.name||e.checked||a.answerIds.push(e.value)}))}break;case"Hash ID":a.questionId="Hash ID",a.answerIds.push(r);break;case"Survey Question":a.questionId=l()(".unsubscribe-survey-modal-question")[0].innerText,t.length&&a.answerIds.push(t[0].value);break;case"Leave a Comment":a.questionId="Leave a Comment",a.answerIds.push(o)}n.answers.push(a)})),function(e,t){l.a.ajax({url:Object(d.a)("/user-proxy/unsubscribe-survey"),type:"POST",data:e,success:t})}(n,e)},v=function(){var e=new u.a(l()(".unsubscribe-survey-modal"),"unsubscribe-survey-modal");setTimeout((function(){e.open(),a()(s.o).subscribe((function(e,t){0===t.closest(".unsubscribe-survey-modal").length||t[0].classList.contains("close-modal-link")?(e.preventDefault(),m()):t[0].classList.contains("submit")&&(e.preventDefault(),b(m))})),l()(".unsubscribe-survey-modal button.close").on("click",(function(e){e.preventDefault(),m()}))}),0)};l()("#newsletterUnsubscribeForm").on("submit",(function(e){e.preventDefault();var t=l()('input[name="newsletterId"]').val(),o=document.querySelectorAll(".checkbox"),n=Array.from(o).filter((function(e){return"objector"===e.name})).map((function(e){return"objector"===e.name&&e.checked?"".concat(e.value,":in"):"objector"===e.name&&!e.checked&&"".concat(e.value,":out")})).filter((function(e){return!1!==e})).join(",");!function(e,t){l.a.ajax({url:Object(d.a)("/element-api/content-proxy/updateNewslettersByHashId"),type:"POST",data:e,complete:t})}({hashId:r,optout:t,objectors:n},v),f.label=t,f.userDecisionArea="Unsubscribe",window.analytics.track("newsletter unsubscribe page",f)})),l()(".newsletter-management .unsubscribe").on("click",(function(e){e.preventDefault(),l()("#newsletterUnsubscribeForm").submit()})),l()(".newsletter-management .cancel-page").on("click",(function(e){e.preventDefault(),window.analytics.track("cancel"),window.location.href="/"}))}};t.default=function(){var e=document.getElementById("newsletterManagementConfig");e&&h(e)}}}]);
//# sourceMappingURL=28-28.js.map